{% extends 'base.html' %}
{% load static %}

{% block body %}
<div id = "exampleModal" class="modal fade" tabindex="-1" role="dialog"  aria-hidden="true">
    <div class="modal-dialog modal-lg ">
        <div class="modal-content">
            <div class=" modal-header">
                <h4 class="col-md-10 text-center modal-title " id="titulo_modal">Canecas </h4>
                <button type="button" class="btn-close  btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

                <div id="conenido_modal" class="modal-body contenido_canecas">
                    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
        </div>
    </div>
</div>


<div id = "modal_datos_usuario" class="modal fade" tabindex="-1" role="dialog"  aria-hidden="true">
    <div class="modal-dialog modal-lg ">
        <div class="modal-content">
            <div class=" modal-header">
                <h4 class="col-md-10 text-center modal-title " id="titulo_datos_usuario">Datos</h4>
                <button type="button" class="btn-close  btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

                <div id="contenido_datos_usuarios" class="modal-body contenido_canecas">
                    
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
        </div>
    </div>
</div>
<div class="m-5  d-flex justify-content-center row completo">
    <table id="example" class="table  table-bordered table-responsive caption-top" >
        <caption>Lista de Productores</caption>
        <thead class="table-otro">
            <th class="text-center" >Usuario</th>
            <th class="text-center" >Nombre</th>       
            <th class="text-center" >Canecas</th>
            <th class="text-center" >Gestionar</th>
        </thead>
        <tbody>
            {% for productor in productores %}
            <tr>
                <td>
                    <a href="javascript:datos_usuario('{{productor.productor.id}}')" >{{productor.productor.username}}</a> 
                </td>
                <td>{{productor.productor.get_full_name}}</td>
                <td class="text-center">
                    <button type="button" class="mb-3 btn btn-info" onclick="buscar_canecas('{{productor.productor.id}}', '{{productor.productor.get_full_name}}')">
                        <svg class="bi login__icon" width="20" height="20" fill="currentColor">
                            <use xlink:href="{% static 'css/bootstrap-icons/bootstrap-icons.svg'%}#box"/>
                        </svg> Ver canecas
                        
                    </button>
                    
                </td>
                <td class="text-center">
                    {%if productor.productor.id in aceptados %}
                        <button id="aceptar{{productor.productor.id}}" type="button" class="btn btn-primary m-0 " onclick="aceptar_productor('{{productor.productor.id}}')" disabled>Aceptar</button>    
                    {% else %}
                        <button id="aceptar{{productor.productor.id}}" type="button" class="btn btn-primary m-0 " onclick="aceptar_productor('{{productor.productor.id}}')">Aceptar</button>    
                    {% endif %}
                    <button type="button" class="btn btn-secondary m-0" onclick="rechazar_visualizacion('productor','{{productor.productor.id}}')">Rechazar</button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>


    
{% endblock %}

{% block stylesheets %}
    {{block.super}}
    <link rel="stylesheet" href="{% static 'css/consulta.css'%}">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap5.min.css">
    <style>
        .contenido_canecas{
            overflow: scroll;
        }
    </style>
{% endblock%}

{% block javascripts %}
    {{block.super}}
    {% if form.errors %}
        {{ form.errors|json_script:"errores" }}
        <script>
            var errores = JSON.parse(document.getElementById('errores').textContent);
            var consolidado = "";
            for (const error in errores) {
                consolidado += `${error}:\n\t ${errores[error]}\n`;
            }
            send_notification( 'error','Error',consolidado,'3000')
        </script>
    {% endif %}
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap5.min.js"></script>
    <script scr="https://cdn.datatables.net/plug-ins/1.12.1/i18n/es-ES.json"></script>
    <script src="{% static 'js/consulta.js'%}"></script>
{% endblock%}